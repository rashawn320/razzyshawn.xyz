<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Demo</title>
</head>

<body>
    <h1>WebSocket Demo</h1>
    <div id="status">Connecting...</div>
</body>

<script>
    let ws;
    const statusElement = document.getElementById('status');

    try {
        // Choose correct WebSocket protocol
        const proto = window.location.protocol === 'https:' ? 'wss' : 'ws';
        ws = new WebSocket(`${proto}://${window.location.host}`);

        // WebSocket event listeners
        ws.onopen = () => {
            console.log('WebSocket connection established');
            statusElement.textContent = 'Connected';
        };

        ws.onmessage = (event) => {
            console.log('Message received:', event.data);
        };

        ws.onerror = (error) => {
            console.error('WebSocket error:', error);
            statusElement.textContent = 'Connection error';
        };

        ws.onclose = () => {
            console.log('WebSocket connection closed');
            statusElement.textContent = 'Disconnected';
        };
    } catch (e) {
        console.error('Failed to establish WebSocket connection:', e);
        statusElement.textContent = 'Connection failed';
    }
</script>

</html>